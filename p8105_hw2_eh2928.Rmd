---
title: "Data Science 1, Homework 2"
author: "Emil Hafeez (eh2928)"
date: "9/24/2020"
output: github_document
---
## Read in the libraries
```{r setup, include = FALSE,warning = FALSE, message = FALSE}
library(tidyverse)
library(readxl)
```

# Problem One

#Read in the Mr Trash Wheel data, and process it.
Here, we read in the data from the Mr. Trashwheel sheet of an Excel document, to create a dataframe. Mr. Trash Wheel is great! I met him when I lived in Baltimore in 2016 to 2018. I follow him on Instagram. 

We specify the data in the sheet, as well as clean the variable names, drop the rows without dumpster-specific data (which appear to be subtotals in the original sheet), and then round a variable to the nearest integer and store that variable respectively as an integer. That's it! In 10 lines! 
```{r trashwheel df and cleaning}
trashwheel_df = 
    read_xlsx(
      path =  "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
      sheet = "Mr. Trash Wheel",
      range = cell_cols("A:N")) %>% 
    janitor::clean_names() %>% 
    drop_na(dumpster) %>% 
	mutate(
		sports_balls = round(sports_balls),
		sports_balls = as.integer(sports_balls)
      )
```
#Implement a similar process for the 2017 and 2018 precipitation data sheets from the same file. 
We implement a similar cleaning process as above, though instead for two years of precipitation data. We also omit rows without precipitation data, and also add a variable for the year.
```{r precipitation_2017_df}
precipitation_2017_df = 
    read_xlsx(
      path =  "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
      sheet = "2017 Precipitation", 
		  skip = 1) %>% 
    janitor::clean_names() %>% 
    drop_na(month) %>% 
	mutate(year = 2017) %>% 
  relocate(year, before = month)
```

```{r precipitation_2018_df}
precipitation_2018_df = 
    read_xlsx(
      path =  "./data/Trash-Wheel-Collection-Totals-8-6-19.xlsx",
      sheet = "2018 Precipitation", 
		  skip = 1) %>% 
    janitor::clean_names() %>% 
    drop_na(month) %>% 
	mutate(year = 2018) %>% 
  relocate(year, before = month)
```
We now combine the 2017 and 2018 datasets, and convert the month into a character variable.
The month-conversion is accomplished with the help of a 'helper' tibble. I vary the order of commands from the demonstrated code, to cluster the related actions closer (and just to experiment and make sure it also works that way).

```{r combine precipitation dataframes and change the month var}
precipitation_combined_df = 
	bind_rows(precipitation_2018_df, precipitation_2017_df)

month_helper_df = 
	tibble(
		month = 1:12,
		month_name = month.name
	)

precipitation_combined_df =
	left_join(precipitation_combined_df, month_helper_df, by = "month")
```
These data relate information on the date, type, volume, and counts of various trash collected by Baltimore's beloved Mr. Trash Wheel. Additional data sheets include monthly precipitation data, and other Trash Wheel's data (the latter of which  we do not utilize). Note that in the Mr. Trash Wheel dataframe, there are `r nrow(trashwheel_df)` rows, and `r ncol(trashwheel_df)` columns. Meanwhile,  the precipitation dataset representing the combination of 2017 and 2018 data has `r nrow(precipitation_combined_df)` rows and `r ncol(precipitation_combined_df)` columns. There was `r precipitation_combined_df %>% filter(year == 2018) %>%  pull(total) %>% sum()` inches of precipitation in 2018! 


Mr. Trash Wheel, amazingly, prevented `r trashwheel_df %>% filter(year == 2017) %>% pull(weight_tons) %>% sum()` tons of trash from entering the Baltimore Inner Harbor in 2017 and `r trashwheel_df %>% filter(year == 2018) %>% pull(weight_tons) %>% sum()` tons in 2018. The median number of sports balls in a 2017 dumpster was `r trashwheel_df %>% filter(year == 2017) %>% pull(sports_balls) %>% median()`.

# Problem Two
Here, we focus on NYC Transit data relating to entrances and exits for each subway station in NYC. 

Read and clean the data; retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance. Convert the entry variable from character (YES vs NO) to a logical variable.

```{r NYC Transit cleanings, warning = FALSE, message = FALSE, results = FALSE}
transit_df =
  read_csv(
      "./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(line:vending, ada, -exit_only) %>% 
  mutate(entry = recode(entry, YES = TRUE, NO = FALSE)) %>% 
  mutate(vending = recode(vending, YES = TRUE, NO = FALSE)) 
```

```{r how many stations ada compliant}
  distinct(transit_df, line, station_name) %>% 
  nrow() 
  
  select(ada) %>% 
    mutate(ada = as.numeric(ada)) %>% 
      distinct(transit_df, line, station_name) %>% 
          count()
```


These data relate information on NYC subway lines, routes, and station characteristics. It has `r nrow(transit_df)` rows, and `r ncol(transit_df)` columns; they are a subset of the raw data. We've selected this subset of the raw data, as well as cleaned the variable names, and converted two variables to a logical variable (I took the liberty with "entry").

Note that there are `r distinct(transit_df, line, station_name) %>% nrow()` distinct stations (by line and station_name combination). Only `r ` of the `r distinct(transit_df, line, station_name) %>% nrow()` distinct stations are ADA compliant. 
